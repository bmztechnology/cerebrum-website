<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>gui.panels.training_panel &mdash; Cerebrum Forex Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />


    <link rel="shortcut icon" href="../../../_static/icon.ico" />
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
</head>

<body class="wy-body-for-nav">
    <div class="wy-grid-for-nav">
        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
            <div class="wy-side-scroll">
                <div class="wy-side-nav-search" style="background: #1e293b">



                    <a href="/" class="icon icon-home">
                        Cerebrum Forex
                        <img src="../../../_static/icon.ico" class="logo" alt="Logo" />
                    </a>
                    <div role="search">
                        <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
                            <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
                            <input type="hidden" name="check_keywords" value="yes" />
                            <input type="hidden" name="area" value="default" />
                        </form>
                    </div>
                </div>
                <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
                    <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
                    <ul>
                        <li class="toctree-l1"><a class="reference internal"
                                href="../../../installation.html">Installation</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../installation.html#prerequisites">Prerequisites</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../installation.html#installation-via-setup">Installation via
                                        Setup</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../installation.html#developer-installation">Developer
                                        Installation</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../installation.html#metatrader-5-configuration">MetaTrader 5
                                        Configuration</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../installation.html#verifying-the-installation">Verifying the
                                        Installation</a></li>
                            </ul>
                        </li>
                        <li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick
                                Start</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../quickstart.html#step-1-connect-to-mt5">Step 1: Connect to MT5</a>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../quickstart.html#step-2-data-extraction">Step 2: Data
                                        Extraction</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../quickstart.html#step-3-model-training">Step 3: Model Training</a>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../quickstart.html#step-4-predictions">Step 4: Predictions</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../quickstart.html#signal-interpretation">Signal Interpretation</a>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../quickstart.html#next-steps">Next Steps</a></li>
                            </ul>
                        </li>
                        <li class="toctree-l1"><a class="reference internal" href="../../../user_manual.html">Manuel
                                Fonctionnel - Cerebrum FX AI</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#table-des-matieres">Table des matières</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#dashboard">Dashboard</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#sous-onglets-dashboard">Sous-onglets
                                                Dashboard</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#section-mt5-account-info">Section MT5
                                                Account Info</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#boutons-d-action">Boutons d’action</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#open-positions">Open Positions</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#onglet-prediction">Onglet Prediction</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#live-operations">Live Operations</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#signal">Signal</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#ea-manager">EA Manager</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-order">Onglet Order</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-position">Onglet Position</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-risk">Onglet Risk</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-prop-firm">Onglet Prop Firm</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-trailing">Onglet Trailing</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-ea-logs">Onglet EA Logs</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-ea-analytics">Onglet EA
                                                Analytics</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#dashboard-sous-onglets">Dashboard -
                                        Sous-onglets</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-calendar">Onglet Calendar</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-signals-chart">Onglet
                                                Signals-Chart</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-trading">Onglet Trading</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#extraction">Extraction</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#ohlc-files-tab">OHLC Files Tab</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#indicators">Indicators</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#categories">Catégories</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#training">Training</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#training-pipeline">Training Pipeline</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#boutons">Boutons</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#model-status">Model Status</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#settings">Settings</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-general">Onglet General</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-data-paths">Onglet Data Paths</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-ai-signals">Onglet AI Signals</a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#onglet-logic-tuning">Onglet Logic
                                                Tuning</a></li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../user_manual.html#raccourcis-et-bonnes-pratiques">Raccourcis et
                                        bonnes pratiques</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#workflow-recommande">Workflow
                                                recommandé</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../user_manual.html#tips-prop-firm">Tips Prop Firm</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
                    <ul>
                        <li class="toctree-l1"><a class="reference internal" href="../../../api/core.html">Core Module
                                Reference</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.mt5_connector">MT5 Connector</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.mt5_connector.MT5Connector"><code
                                                    class="docutils literal notranslate"><span class="pre">MT5Connector</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.add_callback"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.add_callback()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.close_all_positions"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.close_all_positions()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.connect"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.connect()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.check_health"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.check_health()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.disconnect"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.disconnect()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.test_connection"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.test_connection()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.preload_history"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.preload_history()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_terminal_data_path"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_terminal_data_path()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_current_server_time"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_current_server_time()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_server_time"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_server_time()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_time_offset"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_time_offset()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_account_info"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_account_info()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_market_status"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_market_status()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_ohlc_path"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_ohlc_path()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.extract_ohlc"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.extract_ohlc()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.update_all_ohlc"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.update_all_ohlc()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_buffer"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_buffer()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_latest_candles"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_latest_candles()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.load_ohlc"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.load_ohlc()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.load_ohlc_buffer"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.load_ohlc_buffer()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.get_ohlc_status"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.get_ohlc_status()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.mt5_connector.MT5Connector.extract_all"><code
                                                            class="docutils literal notranslate"><span class="pre">MT5Connector.extract_all()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.mt5_connector.get_mt5_connector"><code
                                                    class="docutils literal notranslate"><span class="pre">get_mt5_connector()</span></code></a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.prediction_engine">Prediction
                                        Engine</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.prediction_engine.PredictionEngine"><code
                                                    class="docutils literal notranslate"><span class="pre">PredictionEngine</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.add_callback"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.add_callback()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.remove_callback"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.remove_callback()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.get_signal_path"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.get_signal_path()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.get_enabled_models"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.get_enabled_models()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.predict_timeframe"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.predict_timeframe()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.load_signal"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.load_signal()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.reset_engine"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.reset_engine()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.predict_all"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.predict_all()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.get_prediction_status"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.get_prediction_status()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.get_combined_signal"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.get_combined_signal()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.prediction_engine.PredictionEngine.get_congress_history"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionEngine.get_congress_history()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.training_manager">Training Manager</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.training_manager.TrainingLogBridge"><code
                                                    class="docutils literal notranslate"><span class="pre">TrainingLogBridge</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingLogBridge.emit"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingLogBridge.emit()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.training_manager.RecoveryRequired"><code
                                                    class="docutils literal notranslate"><span class="pre">RecoveryRequired</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.training_manager.TrainingManager"><code
                                                    class="docutils literal notranslate"><span class="pre">TrainingManager</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.add_callback"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.add_callback()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.get_model"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.get_model()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.get_normalizer"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.get_normalizer()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.get_training_status"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.get_training_status()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.should_train_incremental"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.should_train_incremental()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.prepare_training_data"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.prepare_training_data()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.train_timeframe"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.train_timeframe()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.train_all"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.train_all()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.train_with_drift_check"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.train_with_drift_check()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.start_scheduled_training"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.start_scheduled_training()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.stop_scheduled_training"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.stop_scheduled_training()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.training_manager.TrainingManager.load_all_models"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingManager.load_all_models()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.feature_engine">Feature Engine</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.feature_engine.FeatureEngine"><code
                                                    class="docutils literal notranslate"><span class="pre">FeatureEngine</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.feature_engine.FeatureEngine.calculate_all_features"><code
                                                            class="docutils literal notranslate"><span class="pre">FeatureEngine.calculate_all_features()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.feature_engine.FeatureEngine.get_feature_columns"><code
                                                            class="docutils literal notranslate"><span class="pre">FeatureEngine.get_feature_columns()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.feature_engine.FeatureEngine.select_best_features"><code
                                                            class="docutils literal notranslate"><span class="pre">FeatureEngine.select_best_features()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.app_controller">App Controller</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.app_controller.AppController"><code
                                                    class="docutils literal notranslate"><span class="pre">AppController</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.mt5"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.mt5</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.training_manager"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.training_manager</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.prediction_engine"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.prediction_engine</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.scheduler"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.scheduler</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.start"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.start()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.stop"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.stop()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.extract_all"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.extract_all()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.predict_manual"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.predict_manual()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.train_all"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.train_all()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.predict_all"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.predict_all()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_signal"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_signal()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_combined_signal"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_combined_signal()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_ohlc_status"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_ohlc_status()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_training_status"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_training_status()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_model"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_model()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_settings"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_settings()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_cached_account_info"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_cached_account_info()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.save_settings"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.save_settings()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.get_congress_config"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.get_congress_config()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.save_congress_config"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.save_congress_config()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.update_scheduler_config"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.update_scheduler_config()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.sync_ea_config"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.sync_ea_config()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.app_controller.AppController.log_training_event"><code
                                                            class="docutils literal notranslate"><span class="pre">AppController.log_training_event()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.noble_kpi">Noble KPI</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#noble-safe-range-kpi-core-module">Noble
                                                Safe Range KPI - Core Module</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.MarketRegime"><code
                                                    class="docutils literal notranslate"><span class="pre">MarketRegime</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.noble_kpi.MarketRegime.NORMAL"><code
                                                            class="docutils literal notranslate"><span class="pre">MarketRegime.NORMAL</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.noble_kpi.MarketRegime.LOW_VOL"><code
                                                            class="docutils literal notranslate"><span class="pre">MarketRegime.LOW_VOL</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.noble_kpi.MarketRegime.HIGH_VOL"><code
                                                            class="docutils literal notranslate"><span class="pre">MarketRegime.HIGH_VOL</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.noble_kpi.MarketRegime.CRISIS"><code
                                                            class="docutils literal notranslate"><span class="pre">MarketRegime.CRISIS</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.calculate_atr_series"><code
                                                    class="docutils literal notranslate"><span class="pre">calculate_atr_series()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.detect_regime_series"><code
                                                    class="docutils literal notranslate"><span class="pre">detect_regime_series()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.calculate_atr"><code
                                                    class="docutils literal notranslate"><span class="pre">calculate_atr()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.detect_regime"><code
                                                    class="docutils literal notranslate"><span class="pre">detect_regime()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.noble_safe_range"><code
                                                    class="docutils literal notranslate"><span class="pre">noble_safe_range()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.calculate_position"><code
                                                    class="docutils literal notranslate"><span class="pre">calculate_position()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.get_recommendation"><code
                                                    class="docutils literal notranslate"><span class="pre">get_recommendation()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.analyze_timeframe"><code
                                                    class="docutils literal notranslate"><span class="pre">analyze_timeframe()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.validate_kpi"><code
                                                    class="docutils literal notranslate"><span class="pre">validate_kpi()</span></code></a>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.noble_kpi.calculate_noble_bias"><code
                                                    class="docutils literal notranslate"><span class="pre">calculate_noble_bias()</span></code></a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.congress_engine">Congress Engine</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.congress_engine.AladdinPersona"><code
                                                    class="docutils literal notranslate"><span class="pre">AladdinPersona</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.AladdinPersona.QUANT"><code
                                                            class="docutils literal notranslate"><span class="pre">AladdinPersona.QUANT</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.AladdinPersona.ARCHIVIST"><code
                                                            class="docutils literal notranslate"><span class="pre">AladdinPersona.ARCHIVIST</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.AladdinPersona.FUTURIST"><code
                                                            class="docutils literal notranslate"><span class="pre">AladdinPersona.FUTURIST</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.AladdinPersona.GUARDIAN"><code
                                                            class="docutils literal notranslate"><span class="pre">AladdinPersona.GUARDIAN</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.AladdinPersona.LEADER"><code
                                                            class="docutils literal notranslate"><span class="pre">AladdinPersona.LEADER</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.AladdinPersona.SENTINEL"><code
                                                            class="docutils literal notranslate"><span class="pre">AladdinPersona.SENTINEL</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.congress_engine.ModelPrediction"><code
                                                    class="docutils literal notranslate"><span class="pre">ModelPrediction</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.ModelPrediction.model_name"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelPrediction.model_name</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.ModelPrediction.model_role"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelPrediction.model_role</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.ModelPrediction.score"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelPrediction.score</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.ModelPrediction.confidence"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelPrediction.confidence</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.ModelPrediction.regime"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelPrediction.regime</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.ModelPrediction.timeframe"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelPrediction.timeframe</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.ModelPrediction.timestamp"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelPrediction.timestamp</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.congress_engine.CongressDecision"><code
                                                    class="docutils literal notranslate"><span class="pre">CongressDecision</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.final_signal"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.final_signal</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.final_score"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.final_score</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.final_confidence"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.final_confidence</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.detected_regime"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.detected_regime</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.certainty_boost"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.certainty_boost</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.flux_boost"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.flux_boost</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.trend_certainty"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.trend_certainty</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.duration_tf5"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.duration_tf5</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.threshold"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.threshold</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.model_predictions"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.model_predictions</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.flux_details"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.flux_details</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.weights_applied"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.weights_applied</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.timestamp"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.timestamp</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.override_type"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.override_type</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressDecision.to_dict"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressDecision.to_dict()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.congress_engine.CongressEngine"><code
                                                    class="docutils literal notranslate"><span class="pre">CongressEngine</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.CONGRESS_WEIGHTS"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.CONGRESS_WEIGHTS</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.DEFAULT_WEIGHTS"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.DEFAULT_WEIGHTS</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.BASE_THRESHOLD"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.BASE_THRESHOLD</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.LAMBDA"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.LAMBDA</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.KPI_GAMMA"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.KPI_GAMMA</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.CERTAINTY_BONUS"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.CERTAINTY_BONUS</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.__init__"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.__init__()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.detect_market_regime"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.detect_market_regime()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.calculate_adaptive_threshold"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.calculate_adaptive_threshold()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.get_weights"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.get_weights()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.aggregate"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.aggregate()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.get_decision_history"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.get_decision_history()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.simple_aggregate"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.simple_aggregate()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.make_decision_batch"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.make_decision_batch()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.aggregate_with_regime"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.aggregate_with_regime()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.full_aggregate"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.full_aggregate()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.congress_engine.CongressEngine.save_prediction_json"><code
                                                            class="docutils literal notranslate"><span class="pre">CongressEngine.save_prediction_json()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.congress_engine.get_congress_engine"><code
                                                    class="docutils literal notranslate"><span class="pre">get_congress_engine()</span></code></a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/core.html#module-core.model_scorer">Model Scorer</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.model_scorer.PredictionOutcome"><code
                                                    class="docutils literal notranslate"><span class="pre">PredictionOutcome</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.PredictionOutcome.model_name"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionOutcome.model_name</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.PredictionOutcome.timeframe"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionOutcome.timeframe</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.PredictionOutcome.predicted_signal"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionOutcome.predicted_signal</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.PredictionOutcome.actual_outcome"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionOutcome.actual_outcome</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.PredictionOutcome.confidence"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionOutcome.confidence</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.PredictionOutcome.timestamp"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionOutcome.timestamp</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.model_scorer.ModelScorer"><code
                                                    class="docutils literal notranslate"><span class="pre">ModelScorer</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.ModelScorer.HISTORY_SIZE"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelScorer.HISTORY_SIZE</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.ModelScorer.MIN_SAMPLES"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelScorer.MIN_SAMPLES</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.ModelScorer.DYNAMIC_WEIGHT"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelScorer.DYNAMIC_WEIGHT</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.ModelScorer.EMA_ALPHA"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelScorer.EMA_ALPHA</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.ModelScorer.record_outcome"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelScorer.record_outcome()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.ModelScorer.get_dynamic_weights"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelScorer.get_dynamic_weights()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/core.html#core.model_scorer.ModelScorer.get_model_stats"><code
                                                            class="docutils literal notranslate"><span class="pre">ModelScorer.get_model_stats()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/core.html#core.model_scorer.get_model_scorer"><code
                                                    class="docutils literal notranslate"><span class="pre">get_model_scorer()</span></code></a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="toctree-l1"><a class="reference internal" href="../../../api/models.html">Models
                                Reference</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/models.html#module-models.xgboost_model">XGBoost Model</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/models.html#models.xgboost_model.XGBoostModel"><code
                                                    class="docutils literal notranslate"><span class="pre">XGBoostModel</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.xgboost_model.XGBoostModel.name"><code
                                                            class="docutils literal notranslate"><span class="pre">XGBoostModel.name</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.xgboost_model.XGBoostModel.train"><code
                                                            class="docutils literal notranslate"><span class="pre">XGBoostModel.train()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.xgboost_model.XGBoostModel.predict"><code
                                                            class="docutils literal notranslate"><span class="pre">XGBoostModel.predict()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.xgboost_model.XGBoostModel.load"><code
                                                            class="docutils literal notranslate"><span class="pre">XGBoostModel.load()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/models.html#module-models.lightgbm_model">LightGBM Model</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/models.html#models.lightgbm_model.LightGBMModel"><code
                                                    class="docutils literal notranslate"><span class="pre">LightGBMModel</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.lightgbm_model.LightGBMModel.name"><code
                                                            class="docutils literal notranslate"><span class="pre">LightGBMModel.name</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.lightgbm_model.LightGBMModel.train"><code
                                                            class="docutils literal notranslate"><span class="pre">LightGBMModel.train()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.lightgbm_model.LightGBMModel.predict"><code
                                                            class="docutils literal notranslate"><span class="pre">LightGBMModel.predict()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.lightgbm_model.LightGBMModel.load"><code
                                                            class="docutils literal notranslate"><span class="pre">LightGBMModel.load()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/models.html#module-models.randomforest_model">RandomForest
                                        Model</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/models.html#models.randomforest_model.RandomForestModel"><code
                                                    class="docutils literal notranslate"><span class="pre">RandomForestModel</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.randomforest_model.RandomForestModel.name"><code
                                                            class="docutils literal notranslate"><span class="pre">RandomForestModel.name</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.randomforest_model.RandomForestModel.train"><code
                                                            class="docutils literal notranslate"><span class="pre">RandomForestModel.train()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.randomforest_model.RandomForestModel.predict"><code
                                                            class="docutils literal notranslate"><span class="pre">RandomForestModel.predict()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.randomforest_model.RandomForestModel.load"><code
                                                            class="docutils literal notranslate"><span class="pre">RandomForestModel.load()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/models.html#module-models.stacking_model">Stacking Model</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/models.html#models.stacking_model.StackingModel"><code
                                                    class="docutils literal notranslate"><span class="pre">StackingModel</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.stacking_model.StackingModel.name"><code
                                                            class="docutils literal notranslate"><span class="pre">StackingModel.name</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.stacking_model.StackingModel.train"><code
                                                            class="docutils literal notranslate"><span class="pre">StackingModel.train()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.stacking_model.StackingModel.predict"><code
                                                            class="docutils literal notranslate"><span class="pre">StackingModel.predict()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.stacking_model.StackingModel.load"><code
                                                            class="docutils literal notranslate"><span class="pre">StackingModel.load()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/models.html#module-models.meta_model">Meta Model</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/models.html#models.meta_model.MetaModel"><code
                                                    class="docutils literal notranslate"><span class="pre">MetaModel</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.meta_model.MetaModel.prepare_meta_features"><code
                                                            class="docutils literal notranslate"><span class="pre">MetaModel.prepare_meta_features()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.meta_model.MetaModel.train"><code
                                                            class="docutils literal notranslate"><span class="pre">MetaModel.train()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.meta_model.MetaModel.predict_viability"><code
                                                            class="docutils literal notranslate"><span class="pre">MetaModel.predict_viability()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.meta_model.MetaModel.save"><code
                                                            class="docutils literal notranslate"><span class="pre">MetaModel.save()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/models.html#models.meta_model.MetaModel.load"><code
                                                            class="docutils literal notranslate"><span class="pre">MetaModel.load()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="toctree-l1"><a class="reference internal" href="../../../api/gui.html">GUI
                                Reference</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/gui.html#module-gui.main_window">Main Window</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/gui.html#gui.main_window.MainWindow"><code
                                                    class="docutils literal notranslate"><span class="pre">MainWindow</span></code></a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.main_window.MainWindow.status_changed"><code
                                                            class="docutils literal notranslate"><span class="pre">MainWindow.status_changed</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.main_window.MainWindow.update_signal_display"><code
                                                            class="docutils literal notranslate"><span class="pre">MainWindow.update_signal_display()</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.main_window.MainWindow.closeEvent"><code
                                                            class="docutils literal notranslate"><span class="pre">MainWindow.closeEvent()</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/gui.html#panels">Panels</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/gui.html#module-gui.panels.dashboard_panel">Dashboard
                                                Panel</a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.dashboard_panel.PredictionWorker"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionWorker</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.dashboard_panel.DashboardPanel"><code
                                                            class="docutils literal notranslate"><span class="pre">DashboardPanel</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/gui.html#module-gui.panels.extraction_panel">Extraction
                                                Panel</a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.extraction_panel.ExtractionPanel"><code
                                                            class="docutils literal notranslate"><span class="pre">ExtractionPanel</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/gui.html#module-gui.panels.training_panel">Training
                                                Panel</a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.training_panel.TrainingSignals"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingSignals</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.training_panel.PhaseCard"><code
                                                            class="docutils literal notranslate"><span class="pre">PhaseCard</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.training_panel.TrainingPanel"><code
                                                            class="docutils literal notranslate"><span class="pre">TrainingPanel</span></code></a>
                                                </li>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.training_panel.SchedulerDialog"><code
                                                            class="docutils literal notranslate"><span class="pre">SchedulerDialog</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/gui.html#module-gui.panels.prediction_panel">Prediction
                                                Panel</a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.prediction_panel.PredictionPanel"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionPanel</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/gui.html#module-gui.panels.settings_panel">Settings
                                                Panel</a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.panels.settings_panel.SettingsPanel"><code
                                                            class="docutils literal notranslate"><span class="pre">SettingsPanel</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../api/gui.html#workers">Workers</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../api/gui.html#module-gui.workers.prediction_worker">Prediction
                                                Worker</a>
                                            <ul>
                                                <li class="toctree-l4"><a class="reference internal"
                                                        href="../../../api/gui.html#gui.workers.prediction_worker.PredictionWorker"><code
                                                            class="docutils literal notranslate"><span class="pre">PredictionWorker</span></code></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <p class="caption" role="heading"><span class="caption-text">Resources</span></p>
                    <ul>
                        <li class="toctree-l1"><a class="reference internal"
                                href="../../../changelog.html">Changelog</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../changelog.html#version-1-0-0-january-2026">Version 1.0.0 (January
                                        2026)</a>
                                    <ul>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../changelog.html#new-features">New Features</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../changelog.html#improvements">Improvements</a></li>
                                        <li class="toctree-l3"><a class="reference internal"
                                                href="../../../changelog.html#bug-fixes">Bug Fixes</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li class="toctree-l1"><a class="reference internal"
                                href="../../../contributing.html">Contributing</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../contributing.html#how-to-contribute">How to Contribute</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../contributing.html#code-style">Code Style</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../contributing.html#reporting-bugs">Reporting Bugs</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../contributing.html#contact">Contact</a></li>
                            </ul>
                        </li>
                        <li class="toctree-l1"><a class="reference internal" href="../../../sphinx_tech.html">Sphinx
                                Documentation System</a>
                            <ul>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../sphinx_tech.html#sphinx-engine">⚙️ Sphinx Engine</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../sphinx_tech.html#parsing">🔍 Parsing</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../sphinx_tech.html#reference-resolution">🔗 Reference
                                        Resolution</a></li>
                                <li class="toctree-l2"><a class="reference internal"
                                        href="../../../sphinx_tech.html#tree-generation-rtd-theme">🌳 Tree Generation
                                        (RTD Theme)</a></li>
                            </ul>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
            <nav class="wy-nav-top" aria-label="Mobile navigation menu" style="background: #1e293b">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="../../../index.html">Cerebrum Forex</a>
            </nav>

            <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="navigation" aria-label="Page navigation">
                        <ul class="wy-breadcrumbs">
                            <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
                            <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
                            <li class="breadcrumb-item active">gui.panels.training_panel</li>
                            <li class="wy-breadcrumbs-aside">
                            </li>
                        </ul>
                        <hr />
                    </div>
                    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                        <div itemprop="articleBody">

                            <h1>Source code for gui.panels.training_panel</h1>
                            <div class="highlight">
                                <pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Cerebrum Forex - Advanced Training Panel V2</span>
<span class="sd">Professional training UI with pipeline on top, tabbed status/logs below.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">QWidget</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span>
    <span class="n">QTableWidget</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QGroupBox</span><span class="p">,</span>
    <span class="n">QProgressBar</span><span class="p">,</span> <span class="n">QHeaderView</span><span class="p">,</span> <span class="n">QTextEdit</span><span class="p">,</span> <span class="n">QTabWidget</span><span class="p">,</span> <span class="n">QFrame</span><span class="p">,</span>
    <span class="n">QGridLayout</span><span class="p">,</span> <span class="n">QScrollArea</span><span class="p">,</span> <span class="n">QSplitter</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="p">,</span> <span class="n">QDialog</span><span class="p">,</span>
    <span class="n">QCheckBox</span><span class="p">,</span> <span class="n">QComboBox</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QTimer</span><span class="p">,</span> <span class="n">pyqtSignal</span><span class="p">,</span> <span class="n">QObject</span><span class="p">,</span> <span class="n">QThread</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gui.workers.status_worker</span><span class="w"> </span><span class="kn">import</span> <span class="n">StatusWorker</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFont</span><span class="p">,</span> <span class="n">QColor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">gui.widgets.styled_button</span><span class="w"> </span><span class="kn">import</span> <span class="n">Premium3DButton</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="TrainingSignals">
<a class="viewcode-back" href="../../../api/gui.html#gui.panels.training_panel.TrainingSignals">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TrainingSignals</span><span class="p">(</span><span class="n">QObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Signals for thread-safe UI updates&quot;&quot;&quot;</span>
    <span class="n">update_phase</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>  <span class="c1"># phase_id, status, detail</span>
    <span class="n">update_log</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="n">update_stats</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">training_done</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span></div>



<div class="viewcode-block" id="PhaseCard">
<a class="viewcode-back" href="../../../api/gui.html#gui.panels.training_panel.PhaseCard">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PhaseCard</span><span class="p">(</span><span class="n">QFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compact phase card with vertical layout&quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">icon</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_id</span> <span class="o">=</span> <span class="n">phase_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="n">icon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="s2">&quot;pending&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_ui</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_init_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_style</span><span class="p">(</span><span class="s2">&quot;pending&quot;</span><span class="p">))</span>
        
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        
        <span class="c1"># Icon centered</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">icon_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">icon_label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI Emoji&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">icon_label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_label</span><span class="p">)</span>
        
        <span class="c1"># Title centered</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #e5e7eb;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="p">)</span>
        
        <span class="c1"># Status indicator (small text)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;●&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #6b7280;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Transparent background with colored borders for status</span>
        <span class="n">border_color</span> <span class="o">=</span> <span class="s2">&quot;#4b5563&quot;</span>  <span class="c1"># gray for pending</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="n">border_color</span> <span class="o">=</span> <span class="s2">&quot;#3b82f6&quot;</span>  <span class="c1"># blue</span>
        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span> <span class="n">border_color</span> <span class="o">=</span> <span class="s2">&quot;#10b981&quot;</span>  <span class="c1"># green</span>
        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">border_color</span> <span class="o">=</span> <span class="s2">&quot;#ef4444&quot;</span>  <span class="c1"># red</span>
            
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;PhaseCard </span><span class="se">{{</span><span class="s2"> background: transparent; border-radius: 8px; border: 2px solid </span><span class="si">{</span><span class="n">border_color</span><span class="si">}</span><span class="s2">; </span><span class="se">}}</span><span class="s2">&quot;</span>
    
<div class="viewcode-block" id="PhaseCard.set_status">
<a class="viewcode-back" href="../../../api/gui.html#gui.panels.training_panel.PhaseCard.set_status">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">detail</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="n">status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_style</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;pending&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;●&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #6b7280;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;active&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;◐&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #3b82f6;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;complete&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;✓&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #10b981;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;✗&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #ef4444;&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="PhaseCard.set_progress">
<a class="viewcode-back" href="../../../api/gui.html#gui.panels.training_panel.PhaseCard.set_progress">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">detail</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="k">pass</span>  <span class="c1"># Simplified - no progress bar</span></div>
</div>



<div class="viewcode-block" id="TrainingPanel">
<a class="viewcode-back" href="../../../api/gui.html#gui.panels.training_panel.TrainingPanel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TrainingPanel</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Advanced training panel - takes 65% of main window width&quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_controller</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span> <span class="o">=</span> <span class="n">app_controller</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span> <span class="o">=</span> <span class="n">TrainingSignals</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_training_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_tf_index</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Set size policy for 65% width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>
        
        <span class="c1"># === STAGGERED INITIALIZATION (Non-Blocking) ===</span>
        <span class="c1"># 0.5s: UI Update Only</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_status</span><span class="p">)</span>
        
        <span class="c1"># 0.9s: Pipeline visual initialization (Static check)</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">900</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_pipeline_from_models</span><span class="p">)</span>
        
        <span class="c1"># 4.0s: Heavy Model Scanning (Asynchronous)</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_status_update</span><span class="p">)</span>
        
        <span class="c1"># Register TrainingManager callback once</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">training_manager</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">training_manager</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_tm_event</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_connect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_phase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_phase_update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_log</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_log_update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_stats</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_stats_update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">training_done</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_training_done</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_init_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="c1"># HEADER ROW</span>
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="n">header_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        
        <span class="n">header</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;🧠 Model Training&quot;</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="n">header</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #8b5cf6;&quot;</span><span class="p">)</span>
        <span class="n">header_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        
        <span class="n">header_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Ready&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #10b981;&quot;</span><span class="p">)</span>
        <span class="n">header_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">header_layout</span><span class="p">)</span>
        
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="c1"># CONTROL BAR + STATS</span>
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="n">controls</span> <span class="o">=</span> <span class="n">QFrame</span><span class="p">()</span>
        <span class="n">controls</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background: #2d2d2d; border-radius: 6px; border: 1px solid #3c3c3c;&quot;</span><span class="p">)</span>
        <span class="n">controls_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span>
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        
        <span class="c1"># Single Smart Train button (auto-detects mode)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;🧠 Smart Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8b5cf6&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#9f7aea&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#7c3aed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">140</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_smart_train_auto</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Smart Train: Updates models based on incremental setting&quot;</span><span class="p">)</span>
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="p">)</span>

        <span class="c1"># Incremental training setting is now managed in Settings Panel</span>
        <span class="c1"># We read it directly from config.settings when needed</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;⏹ Stop&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#374151&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#4b5563&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#1f2937&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Interrupt current training process immediately&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_training</span><span class="p">)</span>
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="p">)</span>
        
        <span class="c1"># Info button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;ℹ️ Info&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1e40af&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#2563eb&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#1e3a8a&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_btn</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_info_popup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Show training pipeline explanation&quot;</span><span class="p">)</span>
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info_btn</span><span class="p">)</span>
        
        <span class="c1"># ════════════════════════════════════════════════════════════════</span>
        <span class="c1"># AUTO-TRAIN BUTTON (Scheduler Popup Trigger)</span>
        <span class="c1"># ════════════════════════════════════════════════════════════════</span>
        <span class="c1"># Button that opens the Auto-Training scheduler configuration popup.</span>
        <span class="c1"># Visual indicator: RED when scheduler is OFF, GREEN when scheduler is ON.</span>
        <span class="c1"># The color is updated dynamically via _update_auto_train_btn_color().</span>
        <span class="c1"># ════════════════════════════════════════════════════════════════</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;Auto-Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#991b1b&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#dc2626&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#7f1d1d&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_scheduler_popup</span><span class="p">)</span>  <span class="c1"># Opens scheduler dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Configure Auto-Training Schedule&quot;</span><span class="p">)</span>
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span><span class="p">)</span>
        
        <span class="c1"># Defer color update to allow app_controller to fully initialize</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_auto_train_btn_color</span><span class="p">)</span>
        
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="c1"># Stats inline</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[(</span><span class="s2">&quot;TF&quot;</span><span class="p">,</span> <span class="s2">&quot;timeframe&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Samples&quot;</span><span class="p">,</span> <span class="s2">&quot;samples&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;elapsed&quot;</span><span class="p">)]:</span>
            <span class="n">stat_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_stat_widget</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span> <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;Time&quot;</span> <span class="k">else</span> <span class="s2">&quot;0:00&quot;</span><span class="p">)</span>
            <span class="n">controls_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">stat_frame</span><span class="p">)</span>
            
        <span class="c1"># Delete models button (Right aligned)</span>
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;🗑️&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#991b1b&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#dc2626&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#7f1d1d&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_btn</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_all_models</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Delete ALL models and cache (Clean Slate)&quot;</span><span class="p">)</span>
        <span class="n">controls_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delete_btn</span><span class="p">)</span>
            

        
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span>
        
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="c1"># TRAINING PIPELINE (TOP - FULL WIDTH)</span>
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="n">pipeline_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Training Pipeline&quot;</span><span class="p">)</span>
        <span class="n">pipeline_group</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="n">pipeline_group</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QGroupBox { </span>
<span class="s2">                border: 1px solid #3c3c3c; border-radius: 6px; </span>
<span class="s2">                margin-top: 8px; padding-top: 8px; color: #e5e7eb;</span>
<span class="s2">                background-color: #2d2d2d;</span>
<span class="s2">            }</span>
<span class="s2">            QGroupBox::title { subcontrol-origin: margin; left: 10px; padding: 0 4px; background-color: #2d2d2d; }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        
        <span class="n">pipeline_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">pipeline_group</span><span class="p">)</span>
        <span class="n">pipeline_layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">pipeline_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="n">phases</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;📊&quot;</span><span class="p">,</span> <span class="s2">&quot;Data&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="s2">&quot;🔧&quot;</span><span class="p">,</span> <span class="s2">&quot;Features&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;🏷️&quot;</span><span class="p">,</span> <span class="s2">&quot;Labels&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;normalize&quot;</span><span class="p">,</span> <span class="s2">&quot;📐&quot;</span><span class="p">,</span> <span class="s2">&quot;Normalize&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;train_xgb&quot;</span><span class="p">,</span> <span class="s2">&quot;🌲&quot;</span><span class="p">,</span> <span class="s2">&quot;XGBoost&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;train_lgb&quot;</span><span class="p">,</span> <span class="s2">&quot;🍃&quot;</span><span class="p">,</span> <span class="s2">&quot;LightGBM&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;train_rf&quot;</span><span class="p">,</span> <span class="s2">&quot;🌳&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomForest&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;train_cat&quot;</span><span class="p">,</span> <span class="s2">&quot;🐱&quot;</span><span class="p">,</span> <span class="s2">&quot;CatBoost&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;train_stk&quot;</span><span class="p">,</span> <span class="s2">&quot;🔗&quot;</span><span class="p">,</span> <span class="s2">&quot;Stacking&quot;</span><span class="p">),</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">phase_id</span><span class="p">,</span> <span class="n">icon</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">phases</span><span class="p">):</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">PhaseCard</span><span class="p">(</span><span class="n">phase_id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">icon</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="n">phase_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">card</span>
            <span class="n">pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">phases</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arrow</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;→&quot;</span><span class="p">)</span>
                <span class="n">arrow</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #6b7280; font-size: 14px;&quot;</span><span class="p">)</span>
                <span class="n">arrow</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="n">pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">pipeline_group</span><span class="p">)</span>
        
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="c1"># TABBED SECTION: MODEL STATUS | LIVE LOGS</span>
        <span class="c1"># ══════════════════════════════════════════════════════════════</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QTabWidget::pane { </span>
<span class="s2">                border: 1px solid #3c3c3c; </span>
<span class="s2">                background: #2d2d2d;</span>
<span class="s2">                border-radius: 6px;</span>
<span class="s2">            }</span>
<span class="s2">            QTabBar::tab { </span>
<span class="s2">                background: #1e1e1e; </span>
<span class="s2">                color: #9ca3af; </span>
<span class="s2">                padding: 10px 25px; </span>
<span class="s2">                border: 1px solid #374151;</span>
<span class="s2">                border-bottom: none;</span>
<span class="s2">                border-top-left-radius: 6px;</span>
<span class="s2">                border-top-right-radius: 6px;</span>
<span class="s2">                margin-right: 2px;</span>
<span class="s2">                font-weight: bold;</span>
<span class="s2">            }</span>
<span class="s2">            QTabBar::tab:selected { </span>
<span class="s2">                background: #2d2d2d; </span>
<span class="s2">                color: #e5e7eb;</span>
<span class="s2">                border-top: 2px solid #8b5cf6;</span>
<span class="s2">            }</span>
<span class="s2">            QTabBar::tab:hover:!selected { background: #1f2937; }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        
        <span class="c1"># Tab 1: Model Status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_status_tab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_tab</span><span class="p">,</span> <span class="s2">&quot;📊 Model Status&quot;</span><span class="p">)</span>
        
        <span class="c1"># Tab 2: Live Logs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs_tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_logs_tab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logs_tab</span><span class="p">,</span> <span class="s2">&quot;📝 Live Logs&quot;</span><span class="p">)</span>
        
        <span class="c1"># Tab 3: Training History</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_history_tab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_tab</span><span class="p">,</span> <span class="s2">&quot;📜 History&quot;</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_stat_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QFrame</span><span class="p">:</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">QFrame</span><span class="p">()</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background: transparent; border: none;&quot;</span><span class="p">)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">lbl</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">lbl</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #6b7280; font-size: 9px; border: none;&quot;</span><span class="p">)</span>
        <span class="n">lbl</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">lbl</span><span class="p">)</span>
        
        <span class="n">val</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">val</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stat_</span><span class="si">{</span><span class="n">label</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">val</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="n">val</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #e5e7eb; border: none;&quot;</span><span class="p">)</span>
        <span class="n">val</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">frame</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_status_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># Header with refresh button</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="n">refresh_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;🔄 Refresh&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#059669&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#047857&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#065f46&quot;</span><span class="p">)</span>
        <span class="n">refresh_btn</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
        <span class="n">refresh_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Reload model status from disk&quot;</span><span class="p">)</span>
        <span class="n">refresh_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trigger_status_update</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">refresh_btn</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span> <span class="o">=</span> <span class="n">QTableWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span>
            <span class="s2">&quot;TF&quot;</span><span class="p">,</span> <span class="s2">&quot;Model Status&quot;</span><span class="p">,</span> <span class="s2">&quot;XGBoost&quot;</span><span class="p">,</span> <span class="s2">&quot;LightGBM&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomForest&quot;</span><span class="p">,</span> <span class="s2">&quot;CatBoost&quot;</span><span class="p">,</span> <span class="s2">&quot;Stacking&quot;</span><span class="p">,</span> <span class="s2">&quot;Last Train&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg Acc&quot;</span><span class="p">,</span> <span class="s2">&quot;Models&quot;</span>
        <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">ResizeMode</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setAlternatingRowColors</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QTableWidget { </span>
<span class="s2">                background: #111827;</span>
<span class="s2">                alternate-background-color: #1f2937;</span>
<span class="s2">                gridline-color: #374151;</span>
<span class="s2">                border: none;</span>
<span class="s2">            }</span>
<span class="s2">            QTableWidget::item { padding: 6px; color: #e5e7eb; }</span>
<span class="s2">            QTableWidget::item:selected { background: #3b82f6; }</span>
<span class="s2">            QHeaderView::section { </span>
<span class="s2">                background: #374151; color: #e5e7eb; padding: 8px; border: none; font-weight: bold;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        
        <span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;15m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="s2">&quot;4h&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">timeframes</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeframes</span><span class="p">):</span>
            <span class="n">tf_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">tf</span><span class="p">)</span>
            <span class="n">tf_item</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tf_item</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">))</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tab</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_logs_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># Logs header</span>
        <span class="n">logs_header</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">logs_header</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="n">clear_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;🗑️ Clear&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#374151&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#4b5563&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#1f2937&quot;</span><span class="p">)</span>
        <span class="n">clear_btn</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
        <span class="n">clear_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Clear the logs console output&quot;</span><span class="p">)</span>
        <span class="n">clear_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span><span class="o">.</span><span class="n">clear</span><span class="p">())</span>
        <span class="n">logs_header</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">clear_btn</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">logs_header</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span> <span class="o">=</span> <span class="n">QTextEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QTextEdit {</span>
<span class="s2">                background-color: #0d1117;</span>
<span class="s2">                color: #c9d1d9;</span>
<span class="s2">                font-family: &#39;Cascadia Code&#39;, &#39;Consolas&#39;, monospace;</span>
<span class="s2">                font-size: 11px;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 4px;</span>
<span class="s2">                padding: 8px;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">tab</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_history_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># Header with refresh and clear buttons</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Last 100 Training Events&quot;</span><span class="p">))</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="c1"># Clear History Button</span>
        <span class="n">clear_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;🗑️ Supprimer&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#dc2626&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#b91c1c&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#991b1b&quot;</span><span class="p">)</span>
        <span class="n">clear_btn</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
        <span class="n">clear_btn</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Effacer l&#39;historique des entraînements&quot;</span><span class="p">)</span>
        <span class="n">clear_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_clear_history</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">clear_btn</span><span class="p">)</span>
        
        <span class="n">refresh_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;🔄 Refresh&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#374151&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#4b5563&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#1f2937&quot;</span><span class="p">)</span>
        <span class="n">refresh_btn</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
        <span class="n">refresh_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_load_history</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">refresh_btn</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span> <span class="o">=</span> <span class="n">QTableWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="s2">&quot;Details&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">ResizeMode</span><span class="o">.</span><span class="n">Interactive</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QHeaderView</span><span class="o">.</span><span class="n">ResizeMode</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setEditTriggers</span><span class="p">(</span><span class="n">QTableWidget</span><span class="o">.</span><span class="n">EditTrigger</span><span class="o">.</span><span class="n">NoEditTriggers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setSelectionBehavior</span><span class="p">(</span><span class="n">QTableWidget</span><span class="o">.</span><span class="n">SelectionBehavior</span><span class="o">.</span><span class="n">SelectRows</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QTableWidget {</span>
<span class="s2">                background-color: #1f2937;</span>
<span class="s2">                color: #e5e7eb;</span>
<span class="s2">                gridline-color: #374151;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 4px;</span>
<span class="s2">            }</span>
<span class="s2">            QHeaderView::section {</span>
<span class="s2">                background-color: #111827;</span>
<span class="s2">                color: #9ca3af;</span>
<span class="s2">                padding: 6px;</span>
<span class="s2">                border: 1px solid #374151;</span>
<span class="s2">                font-weight: bold;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="p">)</span>
        
        <span class="c1"># Initial load</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_history</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">tab</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load history from json file&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">DATA_DIR</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
            
            <span class="n">history_file</span> <span class="o">=</span> <span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;training_history.json&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">history_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">return</span>
                
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">history_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">history</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">history</span><span class="p">):</span>
                <span class="c1"># Timestamp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
                
                <span class="c1"># Type (MANUAL/AUTO/SYSTEM)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                
                <span class="c1"># Fix: User reported mix-up. Swapping visual labels.</span>
                <span class="n">display_type</span> <span class="o">=</span> <span class="n">source</span>
                <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;MANUAL&quot;</span><span class="p">:</span>
                    <span class="n">display_type</span> <span class="o">=</span> <span class="s2">&quot;SYSTEM&quot;</span>
                <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;SYSTEM&quot;</span><span class="p">:</span>
                    <span class="n">display_type</span> <span class="o">=</span> <span class="s2">&quot;MANUAL&quot;</span>
                    
                <span class="n">type_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">display_type</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">display_type</span> <span class="o">==</span> <span class="s2">&quot;AUTO&quot;</span><span class="p">:</span>
                    <span class="n">type_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#60a5fa&quot;</span><span class="p">))</span> <span class="c1"># light blue</span>
                <span class="k">elif</span> <span class="n">display_type</span> <span class="o">==</span> <span class="s2">&quot;MANUAL&quot;</span><span class="p">:</span>
                    <span class="n">type_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#8b5cf6&quot;</span><span class="p">))</span> <span class="c1"># violet</span>
                <span class="k">elif</span> <span class="n">display_type</span> <span class="o">==</span> <span class="s2">&quot;SYSTEM&quot;</span><span class="p">:</span>
                     <span class="n">type_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#9ca3af&quot;</span><span class="p">))</span> <span class="c1"># gray</span>
                     
                <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">type_item</span><span class="p">)</span>
                
                <span class="c1"># Status</span>
                <span class="n">status_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;SUCCESS&quot;</span> <span class="ow">in</span> <span class="n">status</span> <span class="ow">or</span> <span class="s2">&quot;COMPLETE&quot;</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                    <span class="n">status_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#10b981&quot;</span><span class="p">))</span>
                <span class="k">elif</span> <span class="s2">&quot;FAIL&quot;</span> <span class="ow">in</span> <span class="n">status</span> <span class="ow">or</span> <span class="s2">&quot;ERROR&quot;</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                    <span class="n">status_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#ef4444&quot;</span><span class="p">))</span>
                <span class="k">elif</span> <span class="s2">&quot;START&quot;</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                    <span class="n">status_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#fbbf24&quot;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">status_item</span><span class="p">)</span>
                
                <span class="c1"># Details</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;details&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load training history: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_clear_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear training history file and refresh table&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMessageBox</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">DATA_DIR</span>
        
        <span class="c1"># Confirmation dialog</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> 
            <span class="s2">&quot;Confirmer la suppression&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Voulez-vous vraiment supprimer tout l&#39;historique des entraînements ?&quot;</span><span class="p">,</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">No</span>
        <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">history_file</span> <span class="o">=</span> <span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;training_history.json&quot;</span>
                <span class="k">if</span> <span class="n">history_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="n">history_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Training history cleared by user&quot;</span><span class="p">)</span>
                
                <span class="c1"># Clear the table</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to clear training history: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Erreur&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Impossible de supprimer l&#39;historique: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_update_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">lbl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QLabel</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;stat_</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lbl</span><span class="p">:</span>
            <span class="n">lbl</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_trigger_status_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trigger background scanning of all model files (Thread-Safe)&quot;&quot;&quot;</span>
        <span class="c1"># 1. Protection against overlapping threads</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;status_thread&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">isRunning</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Status update already running - request ignored.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MODELS_DIR</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span> <span class="o">=</span> <span class="n">QThread</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span> <span class="o">=</span> <span class="n">StatusWorker</span><span class="p">(</span><span class="n">MODELS_DIR</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">moveToThread</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">started</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_apply_status_results</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status Thread Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_worker</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
        
        <span class="c1"># Cleanup reference to avoid &quot;RuntimeError: wrapped C/C++ object deleted&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">cleanup_ref</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cleanup_ref</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">status_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_status_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update UI with results from StatusWorker (Rigid Alignment Fix)&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. Global Status</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="s2">&quot;total_trained&quot;</span><span class="p">]</span>
            <span class="n">total_possible</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">5</span> 
            
            <span class="k">if</span> <span class="n">total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;⚠️ No Models&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #ef4444;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">total</span> <span class="o">&lt;</span> <span class="n">total_possible</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ </span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_possible</span><span class="si">}</span><span class="s2"> Models&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #fbbf24;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;✅ All Models Ready&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #10b981;&quot;</span><span class="p">)</span>
                
            <span class="c1"># 2. Header Stats</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_stat</span><span class="p">(</span><span class="s2">&quot;tf&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;global&#39;</span><span class="p">][</span><span class="s1">&#39;tf_with_models&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/6&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_stat</span><span class="p">(</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">acc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="s2">&quot;avg_accuracy&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_stat</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">acc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>
            
            <span class="c1"># 3. Status Table - RIGID 10-COLUMN STRUCTURE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span>
                <span class="s2">&quot;TF&quot;</span><span class="p">,</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="s2">&quot;XGBoost&quot;</span><span class="p">,</span> <span class="s2">&quot;LightGBM&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomForest&quot;</span><span class="p">,</span> <span class="s2">&quot;CatBoost&quot;</span><span class="p">,</span> <span class="s2">&quot;Stacking&quot;</span><span class="p">,</span> <span class="s2">&quot;Last Train&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg Acc&quot;</span><span class="p">,</span> <span class="s2">&quot;Models&quot;</span>
            <span class="p">])</span>
            
            <span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;15m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="s2">&quot;4h&quot;</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeframes</span><span class="p">):</span>
                <span class="n">tf_data</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;timeframes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="p">{})</span>
                <span class="n">tf_accs</span> <span class="o">=</span> <span class="p">[]</span>
                
                <span class="c1"># COL 0: TF (Already set)</span>
                
                <span class="c1"># COL 1: Status (READY/MISSING)</span>
                <span class="n">possible</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="n">actual</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xgboost&quot;</span><span class="p">,</span> <span class="s2">&quot;lightgbm&quot;</span><span class="p">,</span> <span class="s2">&quot;randomforest&quot;</span><span class="p">,</span> <span class="s2">&quot;catboost&quot;</span><span class="p">,</span> <span class="s2">&quot;stacking&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">tf_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">status_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;✅ READY&quot;</span> <span class="k">if</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">possible</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;⚠️ </span><span class="si">{</span><span class="n">actual</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">possible</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">status_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#10b981&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">possible</span> <span class="k">else</span> <span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#fbbf24&quot;</span><span class="p">))</span>
                <span class="n">status_item</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">status_item</span><span class="p">)</span>

                <span class="c1"># COL 2-6: Models</span>
                <span class="n">model_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;xgboost&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;lightgbm&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;randomforest&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;catboost&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;stacking&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">mt</span><span class="p">,</span> <span class="n">col_idx</span> <span class="ow">in</span> <span class="n">model_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="n">tf_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mt</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">tf_accs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
                        <span class="n">item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#10b981&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#e5e7eb&quot;</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">mt</span> <span class="o">==</span> <span class="s2">&quot;stacking&quot;</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#3b82f6&quot;</span><span class="p">))</span> <span class="c1"># Blue</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">))</span>

                <span class="c1"># COL 7: Last Train (Date)</span>
                <span class="n">mtime</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>
                <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="n">model_map</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">tf_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mt</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last_train&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">t</span><span class="p">:</span> <span class="n">mtime</span> <span class="o">=</span> <span class="n">t</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">mtime</span><span class="p">)</span>
                <span class="n">it</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span>

                <span class="c1"># COL 8: Avg Acc</span>
                <span class="k">if</span> <span class="n">tf_accs</span><span class="p">:</span>
                    <span class="n">avg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tf_accs</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">tf_accs</span><span class="p">)</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">))</span>

                <span class="c1"># COL 9: Models Count</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">actual</span><span class="si">}</span><span class="s2">/5&quot;</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error applying rigid model status results: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_init_pipeline_from_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set pipeline to complete status if models already exist&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MODELS_DIR</span>
        
        <span class="c1"># Check if any models exist</span>
        <span class="n">model_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xgboost&quot;</span><span class="p">,</span> <span class="s2">&quot;lightgbm&quot;</span><span class="p">,</span> <span class="s2">&quot;randomforest&quot;</span><span class="p">,</span> <span class="s2">&quot;catboost&quot;</span><span class="p">,</span> <span class="s2">&quot;stacking&quot;</span><span class="p">]</span>
        <span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;15m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="s2">&quot;4h&quot;</span><span class="p">]</span>

        
        <span class="n">has_xgb</span> <span class="o">=</span> <span class="nb">any</span><span class="p">((</span><span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;xgboost_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">)</span>
        <span class="n">has_lgb</span> <span class="o">=</span> <span class="nb">any</span><span class="p">((</span><span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;lightgbm_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">)</span>
        <span class="n">has_rf</span> <span class="o">=</span> <span class="nb">any</span><span class="p">((</span><span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;randomforest_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">)</span>
        <span class="n">has_cat</span> <span class="o">=</span> <span class="nb">any</span><span class="p">((</span><span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;catboost_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">)</span>
        <span class="n">has_stk</span> <span class="o">=</span> <span class="nb">any</span><span class="p">((</span><span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;stacking_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">)</span>
        
        <span class="c1"># If we have any models, set pipeline to complete</span>
        <span class="k">if</span> <span class="n">has_xgb</span> <span class="ow">or</span> <span class="n">has_lgb</span> <span class="ow">or</span> <span class="n">has_rf</span> <span class="ow">or</span> <span class="n">has_cat</span> <span class="ow">or</span> <span class="n">has_stk</span><span class="p">:</span>
            <span class="c1"># Data, Features, Labels, Normalize were completed</span>
            <span class="k">for</span> <span class="n">phase_id</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;normalize&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">phase_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="n">phase_id</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;✓&quot;</span><span class="p">)</span>
            
            <span class="c1"># Model phases</span>
            <span class="k">if</span> <span class="n">has_xgb</span> <span class="ow">and</span> <span class="s2">&quot;train_xgb&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="s2">&quot;train_xgb&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;✓&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">has_lgb</span> <span class="ow">and</span> <span class="s2">&quot;train_lgb&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="s2">&quot;train_lgb&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;✓&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">has_rf</span> <span class="ow">and</span> <span class="s2">&quot;train_rf&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="s2">&quot;train_rf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;✓&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">has_cat</span> <span class="ow">and</span> <span class="s2">&quot;train_cat&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="s2">&quot;train_cat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;✓&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">has_stk</span> <span class="ow">and</span> <span class="s2">&quot;train_stk&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="s2">&quot;train_stk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;✓&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_reset_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">card</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s2">&quot;pending&quot;</span><span class="p">,</span> <span class="s2">&quot;Waiting...&quot;</span><span class="p">)</span>
            <span class="n">card</span><span class="o">.</span><span class="n">set_progress</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_smart_train_auto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Smart training with auto-detection:</span>
<span class="sd">        - If models exist → quick mode (update missing only)</span>
<span class="sd">        - If no models → full mode (train all)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Smart Train button clicked - Auto-detecting mode&quot;</span><span class="p">)</span>
            
            <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MODELS_DIR</span><span class="p">,</span> <span class="n">default_settings</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
            
            <span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;15m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="s2">&quot;4h&quot;</span><span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;🔍 Checking OHLC data freshness...&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span>
            
            <span class="n">needs_training</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">:</span>
                <span class="c1"># Check ALL model types exist (xgboost, lightgbm, randomforest, catboost, stacking)</span>
                <span class="n">model_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xgboost&quot;</span><span class="p">,</span> <span class="s2">&quot;lightgbm&quot;</span><span class="p">,</span> <span class="s2">&quot;randomforest&quot;</span><span class="p">,</span> <span class="s2">&quot;catboost&quot;</span><span class="p">,</span> <span class="s2">&quot;stacking&quot;</span><span class="p">]</span>
                <span class="n">missing_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">mt</span> <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="n">model_types</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mt</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()]</span>
                
                <span class="k">if</span> <span class="n">missing_models</span><span class="p">:</span>
                    <span class="n">needs_training</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tf</span><span class="p">,</span> <span class="s2">&quot;missing&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Missing: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">missing_models</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  📋 </span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">: Missing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_models</span><span class="p">)</span><span class="si">}</span><span class="s2"> models (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">missing_models</span><span class="p">)</span><span class="si">}</span><span class="s2">) → TRAIN&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="c1"># All models exist - check freshness using XGBoost as reference</span>
                <span class="n">model_path</span> <span class="o">=</span> <span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;xgboost_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span>
                
                <span class="c1"># Get last training time from file modification (Local Time)</span>
                <span class="n">model_mtime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">model_path</span><span class="p">))</span>
                <span class="n">last_train_time</span> <span class="o">=</span> <span class="n">model_mtime</span>
                
                <span class="c1"># --- TIMEZONE AWARE FRESHNESS CHECK ---</span>
                <span class="c1"># 1. Get Offset (Local - Server)</span>
                <span class="n">offset_seconds</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">mt5</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
                    <span class="n">offset_seconds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">mt5</span><span class="o">.</span><span class="n">get_time_offset</span><span class="p">()</span>
                
                <span class="c1"># 2. Get OHLC Last Date (Server Time)</span>
                <span class="n">ohlc_path</span> <span class="o">=</span> <span class="n">MODELS_DIR</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;ohlc&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ohlc_EURUSD_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.csv&quot;</span>
                <span class="n">last_candle_local</span> <span class="o">=</span> <span class="kc">None</span>
                
                <span class="k">if</span> <span class="n">ohlc_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Fast last line read</span>
                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ohlc_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># End</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">-</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
                            <span class="n">last_line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">last_line</span><span class="p">:</span>
                                <span class="n">last_ts_str</span> <span class="o">=</span> <span class="n">last_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="n">last_candle_server</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">last_ts_str</span><span class="p">[:</span><span class="mi">19</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
                                <span class="n">last_candle_local</span> <span class="o">=</span> <span class="n">last_candle_server</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">offset_seconds</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">pass</span>
                
                <span class="c1"># 3. Decision Logic: Is Model older than Data?</span>
                <span class="n">is_stale</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                
                <span class="k">if</span> <span class="n">last_candle_local</span><span class="p">:</span>
                     <span class="c1"># Check if model is older than the last candle (with 5 min buffer)</span>
                     <span class="k">if</span> <span class="n">last_train_time</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">last_candle_local</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)):</span>
                         <span class="n">is_stale</span> <span class="o">=</span> <span class="kc">True</span>
                         <span class="n">diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">last_candle_local</span> <span class="o">-</span> <span class="n">last_train_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span>
                         <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;New Data avail (</span><span class="si">{</span><span class="n">diff</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">h)&quot;</span>
                     <span class="k">else</span><span class="p">:</span>
                         <span class="c1"># Also check simple age (in case market is moving but no new file yet?? Unlikely)</span>
                         <span class="k">pass</span>
                
                <span class="c1"># Use strict freshness from Settings</span>
                <span class="n">freshness_hours</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;1m&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;15m&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                    <span class="s2">&quot;1h&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;4h&quot;</span><span class="p">:</span> <span class="mi">24</span>
                <span class="p">}</span>
                <span class="n">limit</span> <span class="o">=</span> <span class="n">freshness_hours</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
                <span class="n">age_hours</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_train_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span>
                
                <span class="k">if</span> <span class="n">is_stale</span><span class="p">:</span>
                    <span class="n">needs_training</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tf</span><span class="p">,</span> <span class="s2">&quot;stale_data&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ⚠️ </span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">: Update Needed (</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">age_hours</span> <span class="o">&gt;</span> <span class="n">limit</span><span class="p">:</span>
                     <span class="c1"># Only trigger age-based update if we suspect we are missing data</span>
                     <span class="c1"># But if file is not updated, training won&#39;t help.</span>
                     <span class="c1"># So we only train if we HAVE data.</span>
                     <span class="c1"># User complaint: &quot;Last dates must be exact&quot;. </span>
                     <span class="c1"># If Age is high but Date matches Server, we are good (Weekend/Holiday).</span>
                     <span class="c1"># We assume if Age &gt; Limit, we SHOULD have new data.</span>
                     <span class="n">check_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Age </span><span class="si">{</span><span class="n">age_hours</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">h &gt; </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s2">h&quot;</span>
                     <span class="n">needs_training</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tf</span><span class="p">,</span> <span class="s2">&quot;stale_time&quot;</span><span class="p">,</span> <span class="n">check_msg</span><span class="p">))</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ⚠️ </span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">: Stale (</span><span class="si">{</span><span class="n">check_msg</span><span class="si">}</span><span class="s2">) → UPDATE&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ </span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">: Fresh (</span><span class="si">{</span><span class="n">age_hours</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">h ago)&quot;</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">)</span>
            
            
            <span class="c1"># Determine mode from Settings</span>
            <span class="n">force_global</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">default_settings</span><span class="o">.</span><span class="n">incremental_training</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;smart&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">force_global</span> <span class="k">else</span> <span class="s2">&quot;full&quot;</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">needs_training</span><span class="p">:</span>
                <span class="c1"># If user wants full retrain, ignore &quot;up-to-date&quot; check</span>
                <span class="k">if</span> <span class="n">force_global</span><span class="p">:</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚀 Force Full Retrain requested...&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">_smart_train</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">selected_timeframes</span><span class="o">=</span><span class="n">timeframes</span><span class="p">)</span> <span class="c1"># Train ALL in full mode</span>
                     <span class="k">return</span>
                     
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;✅ All models are up-to-date!&quot;</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">training_done</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
                <span class="k">return</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚀 Training </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">needs_training</span><span class="p">)</span><span class="si">}</span><span class="s2"> timeframes...&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span>
            
            <span class="c1"># Train only stale/missing timeframes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_smart_train</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">selected_timeframes</span><span class="o">=</span><span class="p">[</span><span class="n">tf</span> <span class="k">for</span> <span class="n">tf</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">needs_training</span><span class="p">])</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
            <span class="n">tb</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[CRITICAL] CRASH IN _smart_train_auto:</span><span class="se">\n</span><span class="si">{</span><span class="n">tb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRASH IN _smart_train_auto: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">tb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Smart Train Loop Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_smart_train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">selected_timeframes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Smart training DELEGATED to TrainingManager.</span>
<span class="sd">        Modes:</span>
<span class="sd">        - full: Retrain ALL models from scratch</span>
<span class="sd">        - quick: Train only missing models</span>
<span class="sd">        - smart: Train only specified timeframes (based on OHLC freshness)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">:</span>
            <span class="k">return</span>
            
        <span class="c1"># UI Setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_training_active</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_training_mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_pipeline</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔄 </span><span class="si">{</span><span class="n">mode</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> Training...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #3b82f6;&quot;</span><span class="p">)</span>
        
        <span class="c1"># Switch to logs tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">mode_icon</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;full&quot;</span><span class="p">:</span> <span class="s2">&quot;🚀&quot;</span><span class="p">,</span> <span class="s2">&quot;quick&quot;</span><span class="p">:</span> <span class="s2">&quot;🔄&quot;</span><span class="p">,</span> <span class="s2">&quot;smart&quot;</span><span class="p">:</span> <span class="s2">&quot;🧠&quot;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="s2">&quot;🔄&quot;</span><span class="p">)</span>
        <span class="n">mode_desc</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;full&quot;</span><span class="p">:</span> <span class="s2">&quot;FULL RETRAIN&quot;</span><span class="p">,</span> <span class="s2">&quot;quick&quot;</span><span class="p">:</span> <span class="s2">&quot;QUICK (missing)&quot;</span><span class="p">,</span> <span class="s2">&quot;smart&quot;</span><span class="p">:</span> <span class="s2">&quot;SMART (stale only)&quot;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">mode</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;═══════════════════════════════════════&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">mode_icon</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mode_desc</span><span class="si">}</span><span class="s2"> (Via TrainingManager)&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;═══════════════════════════════════════&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_elapsed_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elapsed_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_elapsed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elapsed_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        
        <span class="c1"># Determine timeframes to train</span>
        <span class="n">all_timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;15m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="s2">&quot;4h&quot;</span><span class="p">,</span> <span class="s2">&quot;1d&quot;</span><span class="p">,</span> <span class="s2">&quot;1w&quot;</span><span class="p">]</span>
        <span class="c1"># Filter out MN or others if needed</span>
        
        <span class="n">tfs_to_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;smart&quot;</span> <span class="ow">and</span> <span class="n">selected_timeframes</span><span class="p">:</span>
            <span class="n">tfs_to_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">tf</span> <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">selected_timeframes</span> <span class="k">if</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">all_timeframes</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;quick&quot;</span><span class="p">:</span>
            <span class="c1"># Quick check via manager logic ideally, but for now reuse simple check from before</span>
            <span class="c1"># Or better, just train all missing. </span>
            <span class="c1"># Simplified: Use passed list from _smart_train_auto if available, else all</span>
            <span class="c1"># Since _smart_train is called by _smart_train_auto which logic is in UI...</span>
            <span class="c1"># We keep _smart_train_auto logic for SELECTION, but delegation for EXECUTION.</span>
            <span class="k">pass</span> <span class="c1"># Logic handled by caller passed list usually</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_timeframes</span><span class="p">:</span>
                 <span class="n">tfs_to_train</span> <span class="o">=</span> <span class="n">all_timeframes</span> <span class="c1"># Fallback</span>
            <span class="k">else</span><span class="p">:</span>
                 <span class="n">tfs_to_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">tf</span> <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">selected_timeframes</span> <span class="k">if</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">all_timeframes</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tfs_to_train</span> <span class="o">=</span> <span class="n">all_timeframes</span>

        <span class="c1"># Hook up signals</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">training_manager</span>
        
        <span class="c1"># EXECUTION PHASE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">run_thread</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># ════════════════════════════════════════════════════════════════</span>
                <span class="c1"># PHASE 0: BULK OHLC UPDATE (Before any training)</span>
                <span class="c1"># This ensures all training threads have fresh local data and</span>
                <span class="c1"># never need to wait for MT5 IPC during model training.</span>
                <span class="c1"># ════════════════════════════════════════════════════════════════</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;📥 Phase 0: Updating OHLC data...&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_phase</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span> <span class="s2">&quot;Bulk Update...&quot;</span><span class="p">)</span>
                
                <span class="k">def</span><span class="w"> </span><span class="nf">ohlc_callback</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span> <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="s2">&quot;error&quot;</span> <span class="k">else</span> <span class="s2">&quot;error&quot;</span><span class="p">)</span>
                
                <span class="n">mt5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">mt5</span>
                <span class="n">ohlc_results</span> <span class="o">=</span> <span class="n">mt5</span><span class="o">.</span><span class="n">update_all_ohlc</span><span class="p">(</span><span class="n">timeframes</span><span class="o">=</span><span class="n">tfs_to_train</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">ohlc_callback</span><span class="p">)</span>
                
                <span class="c1"># Count results</span>
                <span class="n">fresh_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ohlc_results</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;fresh&quot;</span><span class="p">)</span>
                <span class="n">updated_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ohlc_results</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ OHLC Ready: </span><span class="si">{</span><span class="n">fresh_count</span><span class="si">}</span><span class="s2"> fresh, </span><span class="si">{</span><span class="n">updated_count</span><span class="si">}</span><span class="s2"> updated.&quot;</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_phase</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fresh_count</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">updated_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="c1"># ════════════════════════════════════════════════════════════════</span>
                <span class="c1"># PHASE 1+: MODEL TRAINING (No MT5 calls needed)</span>
                <span class="c1"># ════════════════════════════════════════════════════════════════</span>
                <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">tfs_to_train</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training_active</span><span class="p">:</span>
                        <span class="k">break</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">▶ Training </span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_stats</span><span class="o">.</span><span class="n">emit</span><span class="p">({</span><span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="p">,</span> <span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">})</span>
                    
                    <span class="c1"># Call Manager (No extraction inside, data is already fresh)</span>
                    <span class="n">tm</span><span class="o">.</span><span class="n">train_timeframe</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">force_global</span><span class="o">=</span><span class="p">(</span><span class="n">mode</span><span class="o">==</span><span class="s2">&quot;full&quot;</span><span class="p">))</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✅ </span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2"> sequence complete&quot;</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_reset_pipeline</span><span class="p">()</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">training_done</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
                <span class="n">tb</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TRAINING THREAD CRASH: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">tb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="c1"># FORCE WRITE TO DISK so user can find it even if app disappears</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;TRAINING_CRASH_REPORT.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRASH AT </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tb</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Critical Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">training_done</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run_thread</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">detail</span><span class="p">):</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_update_phase</span><span class="p">(</span><span class="n">phase_id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">detail</span><span class="p">))</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_do_update_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">detail</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">phase_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_cards</span><span class="p">[</span><span class="n">phase_id</span><span class="p">]</span>
            <span class="n">card</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
            <span class="n">card</span><span class="o">.</span><span class="n">set_progress</span><span class="p">(</span><span class="mi">50</span> <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;active&quot;</span> <span class="k">else</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;complete&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_tm_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Bridge between TrainingManager callbacks and UI signals&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_training_active</span><span class="p">:</span> 
            <span class="k">return</span>
            
        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;phase_update&quot;</span><span class="p">:</span>
            <span class="c1"># Filter phase updates during Turbo Parallel training to avoid flickering</span>
            <span class="c1"># Only update if it&#39;s the &quot;Main&quot; timeframe or if it&#39;s a global phase like &quot;normalize&quot;</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">)</span>
            <span class="n">detail</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            
            <span class="c1"># If we are in Turbo Parallel mode, only show global phases or &#39;active&#39; for any</span>
            <span class="c1"># For simplicity, we just allow all but prefix the detail with TF</span>
            <span class="c1"># self.signals.update_phase.emit(phase, status, detail)</span>
            
            <span class="c1"># NEW: Group updates by phase. If any TF is active, set phase to active.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_phase</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
            <span class="c1"># For logs, always show everything but cleaner</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_log</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;model_training_complete&quot;</span><span class="p">:</span>
            <span class="n">acc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">update_stats</span><span class="o">.</span><span class="n">emit</span><span class="p">({</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;training_complete&quot;</span><span class="p">:</span>
            <span class="c1"># This is global complete</span>
            <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">):</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_add_log</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">level</span><span class="p">))</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_do_add_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span>
        
        <span class="c1"># Detect source from app_controller</span>
        <span class="n">source_tag</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">:</span>
            <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">current_training_source</span>
            <span class="n">color_src</span> <span class="o">=</span> <span class="s2">&quot;#60a5fa&quot;</span> <span class="k">if</span> <span class="n">src</span> <span class="o">==</span> <span class="s2">&quot;AUTO&quot;</span> <span class="k">else</span> <span class="s2">&quot;#8b5cf6&quot;</span> <span class="k">if</span> <span class="n">src</span> <span class="o">==</span> <span class="s2">&quot;MANUAL&quot;</span> <span class="k">else</span> <span class="s2">&quot;#9ca3af&quot;</span>
            <span class="n">source_tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;span style=&quot;color:</span><span class="si">{</span><span class="n">color_src</span><span class="si">}</span><span class="s1">; font-weight:bold;&quot;&gt;[</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1">]&lt;/span&gt; &#39;</span>

        <span class="c1"># Clean emojis for console but keep for UI</span>
        <span class="n">clean_msg</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">for</span> <span class="n">emoji</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;📥 &quot;</span><span class="p">,</span> <span class="s2">&quot;🔍 &quot;</span><span class="p">,</span> <span class="s2">&quot;🌲 &quot;</span><span class="p">,</span> <span class="s2">&quot;✅ &quot;</span><span class="p">,</span> <span class="s2">&quot;⚠️ &quot;</span><span class="p">,</span> <span class="s2">&quot;🚀 &quot;</span><span class="p">,</span> <span class="s2">&quot;🧠 &quot;</span><span class="p">,</span> <span class="s2">&quot;🏷️ &quot;</span><span class="p">,</span> <span class="s2">&quot;📉 &quot;</span><span class="p">,</span> <span class="s2">&quot;🔧 &quot;</span><span class="p">,</span> <span class="s2">&quot;🧵 &quot;</span><span class="p">,</span> <span class="s2">&quot;📡 &quot;</span><span class="p">]:</span>
            <span class="n">clean_msg</span> <span class="o">=</span> <span class="n">clean_msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">emoji</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="c1"># Print to terminal for external debugging</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># logger.info(f&quot;[{timestamp}] [{self.app_controller.current_training_source if self.app_controller else &#39;UI&#39;}] {clean_msg}&quot;)</span>
            <span class="k">pass</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="s2">&quot;#9ca3af&quot;</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="s2">&quot;#10b981&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;#ef4444&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span> <span class="s2">&quot;#fbbf24&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="s2">&quot;#8b5cf6&quot;</span><span class="p">}</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="s2">&quot;#9ca3af&quot;</span><span class="p">)</span>
        
        <span class="c1"># Auto-scroll to bottom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;span style=&quot;color:#6b7280;&quot;&gt;[</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">]&lt;/span&gt; </span><span class="si">{</span><span class="n">source_tag</span><span class="si">}</span><span class="s1">&lt;span style=&quot;color:</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">;&quot;&gt;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s1">&lt;/span&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logs_text</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">maximum</span><span class="p">())</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_update_elapsed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_start_time&#39;</span><span class="p">):</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_time</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_stat</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">//</span><span class="mi">60</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">%</span><span class="mi">60</span><span class="p">)</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_show_info_popup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show info dialog explaining each training section&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QDialog</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QTextBrowser</span>
        
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;🧠 Training Pipeline Guide&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background: #1f2937; color: #e5e7eb;&quot;</span><span class="p">)</span>
        
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
        
        <span class="n">text</span> <span class="o">=</span> <span class="n">QTextBrowser</span><span class="p">()</span>
        <span class="n">text</span><span class="o">.</span><span class="n">setOpenExternalLinks</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QTextBrowser {</span>
<span class="s2">                background: #111827;</span>
<span class="s2">                color: #e5e7eb;</span>
<span class="s2">                border: none;</span>
<span class="s2">                border-radius: 8px;</span>
<span class="s2">                padding: 15px;</span>
<span class="s2">                font-size: 12px;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        
        <span class="n">html_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;h2 style=&quot;color: #8b5cf6;&quot;&gt;📊 Training Pipeline&lt;/h2&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #10b981;&quot;&gt;📊 Data&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;Loading OHLC data (Open, High, Low, Close) from MetaTrader 5 or local CSV files. This historical data forms the basis of training.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #10b981;&quot;&gt;🔧 Features&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;Calculation of &lt;b&gt;75+ technical indicators&lt;/b&gt;: SMA, EMA, RSI, MACD, Bollinger Bands, ATR, Ichimoku, etc. These features allow models to understand market patterns.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #10b981;&quot;&gt;🏷️ Labels&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;Creating &lt;b&gt;BUY / SELL / NEUTRAL&lt;/b&gt; labels based on the &lt;b&gt;Noble KPI V3&lt;/b&gt;. This uses a &lt;b&gt;Dynamic K (0.8 - 2.0)&lt;/b&gt; adapted to the Timeframe and &lt;b&gt;Market Regime&lt;/b&gt; (Low Vol, Normal, Crisis) to ensure optimal signal precision.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #10b981;&quot;&gt;📐 Normalize&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;Normalization of features to the &lt;b&gt;[-1, +1]&lt;/b&gt; range using &lt;b&gt;Quantile Transformation&lt;/b&gt; to ensure robust handling of outliers.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;hr style=&quot;border-color: #374151;&quot;&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h2 style=&quot;color: #fbbf24;&quot;&gt;🤖 ML Models&lt;/h2&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #f59e0b;&quot;&gt;🟡 XGBoost&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;&lt;b&gt;Extreme Gradient Boosting&lt;/b&gt; - Ensemble algorithm based on decision trees. Highly performant for tabular data with excellent handling of missing features.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #22c55e;&quot;&gt;🟢 LightGBM&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;&lt;b&gt;Light Gradient Boosting Machine&lt;/b&gt; - Optimized version of gradient boosting. Faster than XGBoost with reduced memory usage, ideal for large datasets.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #10b981;&quot;&gt;🌳 RandomForest&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;&lt;b&gt;Random Forest Classifier&lt;/b&gt; - Ensemble of decision trees using bagging. Robust to overfitting with excellent feature importance analysis.&lt;/p&gt;</span>

<span class="s2">        &lt;h3 style=&quot;color: #eab308;&quot;&gt;🐱 CatBoost (Sentinel)&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;&lt;b&gt;Categorical Boosting&lt;/b&gt; - Yandex&#39;s high-performance algorithm. Uses symmetric trees and ordered boosting to detect subtle patterns others miss. Acts as the &lt;b&gt;Sentinel&lt;/b&gt; of the system.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h3 style=&quot;color: #6366f1;&quot;&gt;🔗 Stacking&lt;/h3&gt;</span>
<span class="s2">        &lt;p&gt;&lt;b&gt;Stacking Ensemble&lt;/b&gt; - Meta-learner that combines XGBoost, LightGBM, RandomForest, and CatBoost predictions using Logistic Regression for improved consensus.&lt;/p&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;hr style=&quot;border-color: #374151;&quot;&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h2 style=&quot;color: #3b82f6;&quot;&gt;📈 Metrics&lt;/h2&gt;</span>
<span class="s2">        &lt;ul&gt;</span>
<span class="s2">            &lt;li&gt;&lt;b&gt;TF&lt;/b&gt;: Number of timeframes with models (e.g., 7/9)&lt;/li&gt;</span>
<span class="s2">            &lt;li&gt;&lt;b&gt;Samples&lt;/b&gt;: Total number of models trained&lt;/li&gt;</span>
<span class="s2">            &lt;li&gt;&lt;b&gt;Accuracy&lt;/b&gt;: Average precision across all models&lt;/li&gt;</span>
<span class="s2">            &lt;li&gt;&lt;b&gt;Time&lt;/b&gt;: Duration of the current training&lt;/li&gt;</span>
<span class="s2">        &lt;/ul&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;hr style=&quot;border-color: #374151;&quot;&gt;</span>
<span class="s2">        </span>
<span class="s2">        &lt;h2 style=&quot;color: #ec4899;&quot;&gt;🚀 Training Modes&lt;/h2&gt;</span>
<span class="s2">        &lt;p&gt;&lt;b&gt;Full Train&lt;/b&gt;: Retrains ALL models from scratch.&lt;/p&gt;</span>
<span class="s2">        &lt;p&gt;&lt;b&gt;Quick Train&lt;/b&gt;: Trains only missing models (faster).&lt;/p&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>
        
        <span class="n">text</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">html_content</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        
        <span class="kn">from</span><span class="w"> </span><span class="nn">gui.widgets.styled_button</span><span class="w"> </span><span class="kn">import</span> <span class="n">Premium3DButton</span>
        <span class="n">close_btn</span> <span class="o">=</span> <span class="n">Premium3DButton</span><span class="p">(</span><span class="s2">&quot;Close&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8b5cf6&quot;</span><span class="p">,</span> <span class="n">hover_color</span><span class="o">=</span><span class="s2">&quot;#9f7aea&quot;</span><span class="p">,</span> <span class="n">pressed_color</span><span class="o">=</span><span class="s2">&quot;#7c3aed&quot;</span><span class="p">)</span>
        <span class="n">close_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dialog</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">close_btn</span><span class="p">)</span>
        
        <span class="n">dialog</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_stop_training</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_training_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;⏹ Stopped by user&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;⏹ Stopped&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #fbbf24;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_elapsed_timer&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_elapsed_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_phase_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase_id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">detail</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle phase update signal&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_update_phase</span><span class="p">(</span><span class="n">phase_id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_log_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_add_log</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_stats_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stats</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;tf&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_stat</span><span class="p">(</span><span class="s2">&quot;tf&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;tf&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;samples&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_stat</span><span class="p">(</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_stat</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_training_done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_training_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_elapsed_timer&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_elapsed_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_btn</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;✅ Complete&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #10b981;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">═══════════════════════════════════════&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;  ✅ TRAINING COMPLETE&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;═══════════════════════════════════════&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">)</span>
        
        <span class="c1"># Force cache clear to ensure fresh data</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_model_cache&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_model_cache</span> <span class="o">=</span> <span class="p">{}</span>
            
        <span class="c1"># Small delay to ensure file system release</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_status</span><span class="p">)</span>
        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_history</span><span class="p">)</span> <span class="c1"># Refresh history tab when done</span>
        
        <span class="c1"># Auto-Enable Incremental Training after Full Retrain (User Request)</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_training_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;full&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">save_settings</span><span class="p">({</span><span class="s2">&quot;incremental_training&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
                <span class="c1"># Update runtime config</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_settings</span>
                <span class="n">default_settings</span><span class="o">.</span><span class="n">incremental_training</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="s2">&quot;  ✅ Incremental Training Auto-Enabled&quot;</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Switch to status tab</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_update_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update model status table from actual files on disk (OPTIMIZED)&quot;&quot;&quot;</span>
        <span class="c1"># Skip if not visible (major perf win)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="k">return</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MODELS_DIR</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
            
            <span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="s2">&quot;5m&quot;</span><span class="p">,</span> <span class="s2">&quot;15m&quot;</span><span class="p">,</span> <span class="s2">&quot;30m&quot;</span><span class="p">,</span> <span class="s2">&quot;1h&quot;</span><span class="p">,</span> <span class="s2">&quot;4h&quot;</span><span class="p">]</span>
            <span class="n">model_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xgboost&quot;</span><span class="p">,</span> <span class="s2">&quot;lightgbm&quot;</span><span class="p">,</span> <span class="s2">&quot;randomforest&quot;</span><span class="p">,</span> <span class="s2">&quot;catboost&quot;</span><span class="p">,</span> <span class="s2">&quot;stacking&quot;</span><span class="p">]</span>
            
            <span class="c1"># Init cache if not exists</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_model_cache&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_model_cache</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {path: (mtime, accuracy)}</span>
            
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeframes</span><span class="p">):</span>
                <span class="n">last_train</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
                
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model_types</span><span class="p">):</span>
                    <span class="c1"># All models use .pkl now</span>
                    <span class="n">model_path</span> <span class="o">=</span> <span class="n">MODELS_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mt</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">tf</span><span class="si">}</span><span class="s2">.pkl&quot;</span>
                    <span class="n">path_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">model_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                        <span class="n">mtime</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
                        
                        <span class="c1"># Check cache: Only reload if mtime changed</span>
                        <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">cached</span> <span class="ow">and</span> <span class="n">cached</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">mtime</span><span class="p">:</span>
                            <span class="n">acc</span> <span class="o">=</span> <span class="n">cached</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Read accuracy from file (expensive, but cached)</span>
                            <span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
                                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                                    <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                                    <span class="n">acc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to read </span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_model_cache</span><span class="p">[</span><span class="n">path_str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mtime</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
                        
                        <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
                        
                        <span class="c1"># Calculate item display</span>
                        <span class="k">if</span> <span class="n">acc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">acc</span> <span class="o">&gt;=</span> <span class="mf">0.65</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#10b981&quot;</span><span class="p">))</span>
                            <span class="k">elif</span> <span class="n">acc</span> <span class="o">&gt;=</span> <span class="mf">0.40</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#fbbf24&quot;</span><span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#ef4444&quot;</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;0.0%&quot;</span><span class="p">)</span>
                            <span class="n">item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#ef4444&quot;</span><span class="p">))</span>
                        
                        <span class="n">mtime_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">mtime</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">last_train</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mtime_dt</span> <span class="o">&gt;</span> <span class="n">last_train</span><span class="p">:</span>
                            <span class="n">last_train</span> <span class="o">=</span> <span class="n">mtime_dt</span>
                        
                        <span class="c1"># COL 2-6: Models</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">empty_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
                        <span class="n">empty_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#6b7280&quot;</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">empty_item</span><span class="p">)</span>
                
                <span class="c1"># COL 0: TF (Index 0)</span>
                
                <span class="c1"># COL 1: Status (Index 1)</span>
                <span class="n">possible</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="n">actual</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>
                <span class="n">status_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;✅ READY&quot;</span> <span class="k">if</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">possible</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;⚠️ </span><span class="si">{</span><span class="n">actual</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">possible</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">status_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#10b981&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">possible</span> <span class="k">else</span> <span class="n">QColor</span><span class="p">(</span><span class="s2">&quot;#fbbf24&quot;</span><span class="p">))</span>
                <span class="n">status_item</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">status_item</span><span class="p">)</span>

                <span class="c1"># Last train date (Index 7)</span>
                <span class="n">time_str</span> <span class="o">=</span> <span class="n">last_train</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m/</span><span class="si">%d</span><span class="s2"> %H:%M&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">last_train</span> <span class="k">else</span> <span class="s2">&quot;Never&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">time_str</span><span class="p">))</span>
                
                <span class="c1"># Average accuracy (Index 8)</span>
                <span class="k">if</span> <span class="n">accuracies</span><span class="p">:</span>
                    <span class="n">avg_acc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>
                    <span class="n">acc_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">avg_acc</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#10b981&quot;</span> <span class="k">if</span> <span class="n">avg_acc</span> <span class="o">&gt;=</span> <span class="mf">0.65</span> <span class="k">else</span> <span class="s2">&quot;#fbbf24&quot;</span> <span class="k">if</span> <span class="n">avg_acc</span> <span class="o">&gt;=</span> <span class="mf">0.40</span> <span class="k">else</span> <span class="s2">&quot;#ef4444&quot;</span>
                    <span class="n">acc_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">acc_item</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">))</span>
                
                <span class="c1"># Models count (Index 9)</span>
                <span class="n">count_item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span><span class="si">}</span><span class="s2">/5&quot;</span><span class="p">)</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#10b981&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;#fbbf24&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;#ef4444&quot;</span>
                <span class="n">count_item</span><span class="o">.</span><span class="n">setForeground</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">count_item</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating status table: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_delete_all_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete all model files and schemas&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMessageBox</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MODELS_DIR</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        
        <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> 
            <span class="s2">&quot;Confirm Delete&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Are you sure you want to delete ALL models and feature schemas?</span><span class="se">\n\n</span><span class="s2">This will force a full retrain and cannot be undone.&quot;</span><span class="p">,</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">No</span>
        <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">StandardButton</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">MODELS_DIR</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">MODELS_DIR</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">suffix</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;.json&#39;</span><span class="p">]:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">f</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
                                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to delete </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🗑️ Deleted </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> model files.&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;⚠️ Deleted&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">global_status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #ef4444;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_status</span><span class="p">()</span>
                
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to delete models: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_auto_train_btn_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update Auto-Train button color based on scheduler state.</span>
<span class="sd">        </span>
<span class="sd">        This method is called:</span>
<span class="sd">        - On startup (via QTimer.singleShot in _init_ui)</span>
<span class="sd">        - After the scheduler popup dialog closes</span>
<span class="sd">        </span>
<span class="sd">        Color logic:</span>
<span class="sd">        - GREEN (#065f46): Scheduler is ACTIVE → automated retraining is enabled</span>
<span class="sd">        - RED (#991b1b): Scheduler is DISABLED → no automated retraining</span>
<span class="sd">        </span>
<span class="sd">        Uses set_color() to preserve the 3D button styling.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">scheduler_enabled</span><span class="p">:</span>
            <span class="c1"># GREEN: Scheduler is active - automated retraining is ON</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#065f46&quot;</span><span class="p">,</span>
                <span class="n">hover</span><span class="o">=</span><span class="s2">&quot;#10b981&quot;</span><span class="p">,</span>
                <span class="n">pressed</span><span class="o">=</span><span class="s2">&quot;#064e3b&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># RED: Scheduler is inactive - user must train manually</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auto_train_btn</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#991b1b&quot;</span><span class="p">,</span>
                <span class="n">hover</span><span class="o">=</span><span class="s2">&quot;#dc2626&quot;</span><span class="p">,</span>
                <span class="n">pressed</span><span class="o">=</span><span class="s2">&quot;#7f1d1d&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_show_scheduler_popup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open the Auto-Training Scheduler configuration popup.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gui.panels.training_panel</span><span class="w"> </span><span class="kn">import</span> <span class="n">SchedulerDialog</span>
            <span class="n">dialog</span> <span class="o">=</span> <span class="n">SchedulerDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
            <span class="c1"># Refresh button color after dialog closes to reflect new state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_auto_train_btn_color</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ CRITICAL ERROR: Failed to open Auto-Train Dialog: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QMessageBox</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Neural Auto-Pilot Error&quot;</span><span class="p">,</span> 
                               <span class="sa">f</span><span class="s2">&quot;Impossible d&#39;ouvrir le planificateur d&#39;entraînement :</span><span class="se">\n</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">L&#39;erreur a été enregistrée dans cerebrum.log.&quot;</span><span class="p">)</span></div>



<span class="c1"># ════════════════════════════════════════════════════════════════════════════</span>
<span class="c1"># SCHEDULER DIALOG (Auto-Training Configuration Popup)</span>
<span class="c1"># ════════════════════════════════════════════════════════════════════════════</span>
<span class="c1"># This dialog allows users to configure the automatic model retraining schedule.</span>
<span class="c1"># Features:</span>
<span class="c1"># - Toggle switch to enable/disable auto-training</span>
<span class="c1"># - Cycle selector (4h, 12h, Daily, Weekly) aligned to market hours</span>
<span class="c1"># - Live countdown display showing time until next execution</span>
<span class="c1"># - Progress bar indicating cycle progress</span>
<span class="c1"># - Save &amp; Quit / Quit buttons</span>
<span class="c1"># ════════════════════════════════════════════════════════════════════════════</span>

<div class="viewcode-block" id="SchedulerDialog">
<a class="viewcode-back" href="../../../api/gui.html#gui.panels.training_panel.SchedulerDialog">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SchedulerDialog</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auto-Training Scheduler Dialog (Pro UI).</span>
<span class="sd">    </span>
<span class="sd">    Modal dialog for configuring the automated model retraining schedule.</span>
<span class="sd">    Changes are saved immediately via app_controller.update_scheduler_config()</span>
<span class="sd">    when the user toggles the switch or changes the cycle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_controller</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span> <span class="o">=</span> <span class="n">app_controller</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;🧠 Neural Auto-Pilot&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">450</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: #1e1e1e;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_ui</span><span class="p">()</span>
        
        <span class="c1"># Timer for live countdown updates (every second)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_countdown</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Update every 1 second</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_countdown</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_init_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
        
        <span class="c1"># Header</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;🧠&quot;</span><span class="p">)</span>
        <span class="n">icon</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI Emoji&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
        
        <span class="n">title_col</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Neural Auto-Pilot&quot;</span><span class="p">)</span>
        <span class="n">title</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="n">title</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: white;&quot;</span><span class="p">)</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Automated retraining scheduler&quot;</span><span class="p">)</span>
        <span class="n">subtitle</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #9ca3af;&quot;</span><span class="p">)</span>
        <span class="n">title_col</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">title_col</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">subtitle</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">title_col</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="c1"># Toggle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;DISABLED&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CursorShape</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QCheckBox { color: #ef4444; font-weight: bold; font-size: 14px; }</span>
<span class="s2">            QCheckBox::indicator { width: 50px; height: 26px; background-color: #374151; border-radius: 13px; }</span>
<span class="s2">            QCheckBox::indicator:checked { background-color: #10b981; }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">scheduler_enabled</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">scheduler_enabled</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;ACTIVE&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">styleSheet</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#ef4444&quot;</span><span class="p">,</span> <span class="s2">&quot;#10b981&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_toggle</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        
        <span class="c1"># Divider</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">QFrame</span><span class="p">()</span>
        <span class="n">line</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">HLine</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: #333333;&quot;</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        
        <span class="c1"># Cycle Row</span>
        <span class="n">cycle_row</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">cycle_lbl</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;RETRAINING CYCLE&quot;</span><span class="p">)</span>
        <span class="n">cycle_lbl</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #6b7280; font-weight: bold;&quot;</span><span class="p">)</span>
        <span class="n">cycle_row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">cycle_lbl</span><span class="p">)</span>
        <span class="n">cycle_row</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s2">&quot;4h&quot;</span><span class="p">,</span> <span class="s2">&quot;12h&quot;</span><span class="p">,</span> <span class="s2">&quot;Daily&quot;</span><span class="p">,</span> <span class="s2">&quot;Weekly&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QComboBox { background: #252526; color: white; border: 1px solid #4b5563; padding: 8px; border-radius: 6px; }</span>
<span class="s2">            QComboBox::drop-down { border: none; width: 25px; }</span>
<span class="s2">            QComboBox::down-arrow { border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 6px solid #4ade80; }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">scheduler_cycle</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFlag</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_cycle_change</span><span class="p">)</span>
        <span class="n">cycle_row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">cycle_row</span><span class="p">)</span>
        
        <span class="c1"># Countdown</span>
        <span class="n">countdown_frame</span> <span class="o">=</span> <span class="n">QFrame</span><span class="p">()</span>
        <span class="n">countdown_frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background: #252526; border-radius: 10px;&quot;</span><span class="p">)</span>
        <span class="n">cf_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">countdown_frame</span><span class="p">)</span>
        <span class="n">cf_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        
        <span class="n">next_lbl</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;NEXT EXECUTION IN&quot;</span><span class="p">)</span>
        <span class="n">next_lbl</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #6b7280; font-weight: bold;&quot;</span><span class="p">)</span>
        <span class="n">next_lbl</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">cf_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">next_lbl</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;--:--:--&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Consolas&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: #60a5fa;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">cf_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span><span class="p">)</span>
        
        <span class="c1"># Progress</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="n">QProgressBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">setTextVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QProgressBar { background: #2d2d2d; border-radius: 5px; }</span>
<span class="s2">            QProgressBar::chunk { background: qlineargradient(x1:0, y1:0, x2:1, y2:0, stop:0 #3b82f6, stop:1 #8b5cf6); border-radius: 5px; }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">cf_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">countdown_frame</span><span class="p">)</span>
        
        <span class="c1"># Buttons Row</span>
        <span class="n">btn_row</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        
        <span class="c1"># Quit Button (Cancel)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quit_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;✕ Quit&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quit_btn</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quit_btn</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CursorShape</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quit_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton { background: #374151; color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 14px; }</span>
<span class="s2">            QPushButton:hover { background: #4b5563; }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quit_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">)</span>
        <span class="n">btn_row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quit_btn</span><span class="p">)</span>
        
        <span class="c1"># Save &amp; Quit Button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;💾 Save &amp; Quit&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_btn</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_btn</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">CursorShape</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton { background: #065f46; color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 14px; }</span>
<span class="s2">            QPushButton:hover { background: #10b981; }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_save</span><span class="p">)</span>  <span class="c1"># Saves settings then closes</span>
        <span class="n">btn_row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_btn</span><span class="p">)</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">btn_row</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle toggle switch change (UI only, no save yet).</span>
<span class="sd">        Settings are only applied when Save is clicked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">checked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;ACTIVE&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">styleSheet</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#ef4444&quot;</span><span class="p">,</span> <span class="s2">&quot;#10b981&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;DISABLED&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">styleSheet</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#10b981&quot;</span><span class="p">,</span> <span class="s2">&quot;#ef4444&quot;</span><span class="p">))</span>
        <span class="c1"># Note: Do NOT save to app_controller here - wait for Save button</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_cycle_change</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle cycle combobox change (UI only, no save yet).</span>
<span class="sd">        Settings are only applied when Save is clicked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note: Do NOT save to app_controller here - wait for Save button</span>
        <span class="k">pass</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_on_save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save settings to app_controller and close dialog.</span>
<span class="sd">        This is the ONLY place where settings are persisted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">:</span>
            <span class="n">enabled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
            <span class="n">cycle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cycle_combo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">update_scheduler_config</span><span class="p">(</span><span class="n">enabled</span><span class="p">,</span> <span class="n">cycle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_update_countdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="p">:</span> <span class="k">return</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">scheduler_enabled</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">next_run_time</span><span class="p">:</span>
            <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">next_run_time</span> <span class="o">-</span> <span class="n">now</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;RUNNING...&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">maximum</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">total</span> <span class="o">//</span> <span class="mi">3600</span><span class="p">),</span> <span class="nb">int</span><span class="p">((</span><span class="n">total</span> <span class="o">%</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">//</span> <span class="mi">60</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">total</span> <span class="o">%</span> <span class="mi">60</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="n">cycle_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;4h&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="s2">&quot;12h&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="s2">&quot;daily&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="s2">&quot;weekly&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span><span class="p">}</span>
                <span class="n">cycle_sec</span> <span class="o">=</span> <span class="n">cycle_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_controller</span><span class="o">.</span><span class="n">scheduler_cycle</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="mi">3600</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cycle_sec</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cycle_sec</span> <span class="o">-</span> <span class="n">total</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">countdown_lbl</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;--:--:--&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

</pre>
                            </div>

                        </div>
                    </div>
                    <footer>

                        <hr />

                        <div role="contentinfo">
                            <p>&#169; Copyright 2026, BMZ Business, LLC.</p>
                        </div>

                        Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
                        <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
                        provided by <a href="https://readthedocs.org">Read the Docs</a>.


                    </footer>
                </div>
            </div>
        </section>
    </div>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>

</html>